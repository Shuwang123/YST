webpackJsonp([27],{"+9G2":function(t,e){},TXrT:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("gyMJ"),i=a("E4LH"),s=(a("iVZN"),{components:{FirstPatientList:a("ychk").default},computed:{sum:function(){return Number(this.dataForm.RegisterAmount)+Number(this.dataForm.ConsultationAmount)}},watch:{"dataForm.RegisterAmount":function(t,e){var a=this;if(0===Number(t))return!1;this.regMoney.test(t)||this.$alert("你输入的金额不合规范! ","输入提示",{confirmButtonText:"确定",callback:function(){a.dataForm.RegisterAmount=""}})},"dataForm.ConsultationAmount":function(t,e){var a=this;if(0===Number(t))return!1;this.regMoney.test(t)||this.$alert("你输入的金额不合规范! ","输入提示",{confirmButtonText:"确定",callback:function(){a.dataForm.ConsultationAmount=""}})},sum:function(t,e){0===t?(this.shiji=!0,this.dataForm.reality=0,this.dataForm.give=0):t>0&&(this.shiji=!1,this.dataForm.reality="",this.dataForm.give="")},"dataForm.reality":function(t,e){var a=this;return 0!==Number(t)&&(this.regMoney.test(t)||this.$alert("你输入的金额不合规范! ","输入提示",{confirmButtonText:"确定",callback:function(){return a.dataForm.reality="",a.dataForm.give="",!1}}),!(Number(t)<this.sum)&&void(this.dataForm.give=Math.round(100*(t-this.sum))/100))}},data:function(){return{regMoney:/^\d+\.?\d{0,2}$/,show:!0,visible:!1,dataListLoading:!1,doctorId:"",doctorName:"",dataForm:{UserName:"",Sex:"",BirthDate:"",MobilePhone:"",Address:"",UserId:"",Code:"",PaymentWay:1,DiagnosisType:"1",chargeType:"只挂号",RegisterAmount:"",ConsultationAmount:0,reality:0,give:0},RegisterBool:!1,ConsultationBool:!0,shiji:!0,dataList:null,addOrUpdateVisible:!1,dataRule:{UserName:Object(i.a)("此为必填项"),RegisterAmount:Object(i.a)("此为必填项"),ConsultationAmount:Object(i.a)("此为必填项"),reality:Object(i.a)("此为必填项"),give:Object(i.a)("此为必填项")},optionsChargeType:[{value:"0元号",label:"0元号"},{value:"只挂号",label:"只挂号"}],optionsPaymentType:[{value:1,label:"现金"},{value:2,label:"支付宝"},{value:3,label:"微信"},{value:4,label:"银行卡"}]}},created:function(){this.$store.commit("setRegisterStep",1)},methods:{patientListFun:function(t){this.show=!this.show,this.dataForm.UserName=t.UserName,this.dataForm.Sex=1===t.Sex?"男":"女",this.dataForm.BirthDate=t.BirthDate,this.dataForm.MobilePhone=t.MobilePhone,this.dataForm.Address=t.Address,this.dataForm.UserId=t.Id,this.dataForm.Code=t.Code},init:function(t){this.visible=!0,this.dataListLoading=!0,void 0!==t&&(this.doctorId=t.Id,this.doctorName=t.NickName),this.dataListLoading=!1},chargeTypeChange:function(t){switch(t){case"0元号":this.dataForm.RegisterAmount=0,this.dataForm.ConsultationAmount=0,this.RegisterBool=!0,this.ConsultationBool=!0;break;case"只挂号":this.dataForm.RegisterAmount="",this.dataForm.ConsultationAmount=0,this.RegisterBool=!1,this.ConsultationBool=!0;break;case"挂号+诊疗":this.dataForm.RegisterAmount="",this.dataForm.ConsultationAmount="",this.RegisterBool=!1,this.ConsultationBool=!1;break;case"只诊疗":this.dataForm.RegisterAmount=0,this.dataForm.ConsultationAmount="",this.RegisterBool=!0,this.ConsultationBool=!1;break;case"疗程":this.dataForm.RegisterAmount=0,this.dataForm.ConsultationAmount=0,this.RegisterBool=!0,this.ConsultationBool=!0}},handleClose:function(){this.show=!0,this.$store.commit("setRegisterStep",1),this.doctorId="",this.doctorName="",this.dataForm={UserName:"",Sex:"",BirthDate:"",MobilePhone:"",Address:"",UserId:"",Code:"",PaymentWay:1,DiagnosisType:"1",chargeType:"只挂号",RegisterAmount:"",ConsultationAmount:0,reality:0,give:0},this.RegisterBool=!1,this.ConsultationBool=!0,this.shiji=!0},realityBlur:function(){Number(this.dataForm.reality)<this.sum&&(this.dataForm.reality="",this.dataForm.give="",this.$message({type:"error",duration:"5000",message:"提示: 实际的收费金额应 ≥ 挂号费!"}))},dataFormSubmitA:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){var a={StoreId:t.$store.getters.getAccountCurrentHandleStore,AccountId:t.doctorId,UserId:t.dataForm.UserId,OrderType:1,DiagnosisType:t.dataForm.DiagnosisType,RegisterAmount:t.dataForm.RegisterAmount,ConsultationAmount:t.dataForm.ConsultationAmount,RegisterStatus:2,PaymentWay:t.dataForm.PaymentWay,Remark:t.dataForm.PaymentWay};o.a.register.registerSubmit(a).then(function(e){"0000"===e.code?(t.$message({message:"挂号成功",type:"success",duration:3e3}),t.visible=!1):t.$message.error(e.message)})}else t.$alert("挂号信息不完整! ","提示",{confirmButtonText:"确定"})})},openPatientList:function(){var t=this;this.addOrUpdateVisible=!0,this.$nextTick(function(){t.$refs.patientList.init()})}}}),r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"registerIndex",attrs:{title:1===t.$store.getters.getRegisterStep?"挂号信息填写":2===t.$store.getters.getRegisterStep?"门店患者调用":"建立新的患者",width:"678px","close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(e){t.visible=e},close:t.handleClose}},[a("transition",{attrs:{mode:"out-in"}},[t.show?a("div",[a("div",{staticClass:"ownScrollbar",staticStyle:{"min-height":"420px","overflow-y":"scroll"}},[a("el-form",{ref:"dataForm",attrs:{rules:t.dataRule,model:t.dataForm,"label-width":"70px",size:"mini",inline:!0}},[a("el-row",[a("el-col",[a("div",{staticStyle:{"padding-top":"5px","font-size":"16px","font-weight":"900",color:"#1CA579"}},[t._v("患者信息：")])])],1),t._v(" "),a("div",{staticStyle:{"padding-left":"32px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"姓名",prop:"UserName"}},[a("el-input",{staticStyle:{width:"80px"},attrs:{placeholder:"选择患者",disabled:""},model:{value:t.dataForm.UserName,callback:function(e){t.$set(t.dataForm,"UserName",e)},expression:"dataForm.UserName"}}),t._v(" "),a("span",{staticClass:"iconfont icon-renwu-zengjia",staticStyle:{display:"inline-block",width:"40px",height:"30px","font-size":"26px","font-weight":"900",color:"#1EA57B","margin-left":"5px","vertical-align":"top"},on:{click:function(e){t.show=!t.show,t.openPatientList(),t.$store.commit("setRegisterStep",2)}}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"性别"}},[a("el-input",{staticStyle:{width:"80px"},attrs:{placeholder:"只读",disabled:""},model:{value:t.dataForm.Sex,callback:function(e){t.$set(t.dataForm,"Sex",e)},expression:"dataForm.Sex"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"年龄"}},[a("el-input",{staticStyle:{width:"80px"},attrs:{placeholder:"只读",disabled:""},model:{value:t.dataForm.BirthDate,callback:function(e){t.$set(t.dataForm,"BirthDate",e)},expression:"dataForm.BirthDate"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"电话"}},[a("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"只读",disabled:""},model:{value:t.dataForm.MobilePhone,callback:function(e){t.$set(t.dataForm,"MobilePhone",e)},expression:"dataForm.MobilePhone"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("p",[t._v("病历编号："),a("span",{domProps:{textContent:t._s(t.dataForm.Code)}})])]),t._v(" "),a("el-col",{attrs:{span:12}},[a("p",[t._v("会员卡号："),a("span",{domProps:{textContent:t._s(t.dataForm.MobilePhone)}})])])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"填写地址"}},[a("el-input",{staticStyle:{width:"465px"},attrs:{placeholder:"请输入地址详情",disabled:""},model:{value:t.dataForm.Address,callback:function(e){t.$set(t.dataForm,"Address",e)},expression:"dataForm.Address"}})],1)],1)],1)],1),t._v(" "),a("el-row",[a("el-col",[a("div",{staticStyle:{"padding-top":"5px","font-size":"16px","font-weight":"900",color:"#1CA579"}},[t._v("医生信息：")])])],1),t._v(" "),a("div",{staticStyle:{"padding-left":"48px"}},[a("p",[t._v("姓名："),a("span",{domProps:{textContent:t._s(t.doctorName)}})])]),t._v(" "),a("el-row",[a("el-col",[a("div",{staticStyle:{"padding-top":"5px","font-size":"16px","font-weight":"900",color:"#1CA579"}},[t._v("收费信息：")])])],1),t._v(" "),a("div",{staticStyle:{"padding-left":"32px"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{model:{value:t.dataForm.DiagnosisType,callback:function(e){t.$set(t.dataForm,"DiagnosisType",e)},expression:"dataForm.DiagnosisType"}},[a("el-radio-button",{attrs:{label:"1"}},[t._v("初诊")]),t._v(" "),a("el-radio-button",{attrs:{label:"2"}},[t._v("复诊")])],1)],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"收费类型"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"收费类型"},on:{change:t.chargeTypeChange},model:{value:t.dataForm.chargeType,callback:function(e){t.$set(t.dataForm,"chargeType",e)},expression:"dataForm.chargeType"}},t._l(t.optionsChargeType,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"挂号费",prop:"RegisterAmount"}},[a("el-input",{staticStyle:{width:"85px"},attrs:{placeholder:"挂号费",clearable:"",disabled:t.RegisterBool},model:{value:t.dataForm.RegisterAmount,callback:function(e){t.$set(t.dataForm,"RegisterAmount",e)},expression:"dataForm.RegisterAmount"}}),t._v(" ￥\n              ")],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"支付方式"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"支付方式"},model:{value:t.dataForm.PaymentWay,callback:function(e){t.$set(t.dataForm,"PaymentWay",e)},expression:"dataForm.PaymentWay"}},t._l(t.optionsPaymentType,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"诊疗费",prop:"ConsultationAmount"}},[a("el-input",{staticStyle:{width:"85px"},attrs:{placeholder:"诊疗费",clearable:"",disabled:t.ConsultationBool,min:"0"},model:{value:t.dataForm.ConsultationAmount,callback:function(e){t.$set(t.dataForm,"ConsultationAmount",e)},expression:"dataForm.ConsultationAmount"}}),t._v(" ￥\n              ")],1)],1)],1),t._v(" "),a("el-row",{staticStyle:{"margin-top":"10px","font-weight":"500","font-size":"16px"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"总共金额"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"总金额",disabled:"",size:"small"},model:{value:t.sum,callback:function(e){t.sum=e},expression:"sum"}}),t._v(" ￥\n              ")],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"实收",prop:"reality"}},[a("el-input",{staticStyle:{width:"90px"},attrs:{clearable:"",size:"small",disabled:t.shiji},on:{blur:t.realityBlur},model:{value:t.dataForm.reality,callback:function(e){t.$set(t.dataForm,"reality",e)},expression:"dataForm.reality"}}),t._v(" ￥\n                ")],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"找零",prop:"give"}},[a("el-input",{staticStyle:{width:"90px"},attrs:{clearable:"",size:"small",disabled:t.shiji},model:{value:t.dataForm.give,callback:function(e){t.$set(t.dataForm,"give",e)},expression:"dataForm.give"}}),t._v(" ￥\n              ")],1)],1)],1)],1)],1)],1),t._v(" "),a("div",{staticStyle:{"text-align":"right","margin-top":"30px"}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dataFormSubmitA()}}},[t._v("挂号")]),t._v(" "),a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")])],1)])]):t._e()]),t._v(" "),a("transition",{attrs:{mode:"out-in"}},[t.show?t._e():a("div",[t.addOrUpdateVisible?a("first-patient-list",{ref:"patientList",on:{childEven:t.patientListFun}}):t._e()],1)])],1)},staticRenderFns:[]};var l=a("VU/8")(s,r,!1,function(t){a("+9G2")},"data-v-e9ff9576",null);e.default=l.exports}});
//# sourceMappingURL=27.8fc684ebca7d6c7c5323.js.map